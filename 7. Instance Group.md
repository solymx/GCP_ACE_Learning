## 實例群組（Instance Group）

- Intro
  -  一群虛擬機被當作單一單位來管理，可以一起操作
  -  2 種 type
    - 受管實例群組（Managed Instance Group，簡稱 MIG）
      - VM 皆為相同配置（相同機器類型、映像檔、設定）
      - 使用實例範本（Instance Template）建立
      - 有很多功能：
        - 自動擴展（Auto-scaling）：依使用量自動調整 VM 數量
        - 自我修復（Auto-healing）：若 VM 健康檢查失敗，會自動替換新 VM
        - 受管更新（Managed Releases）：可進行滾動更新與 Canary 發佈，零停機
    - 非受管實例群組（Unmanaged Instance Group）
      - VM 可有不同配置（不同映像、硬體）
      - 不支援自動擴展或自我修復
      - 僅當你需要異質 VM 時才建議使用
     
### 地理位置選擇：Zonal vs. Regional

- Zonal：所有 VM 都在同一個可用區（Zone）
- Regional：VM 分佈在區域內多個 Zone → 較高可用性

**推薦：若需高可用性，使用 Regional Managed Instance Group**

### 整理

- 若你要管理一群相同設定的 VM，使用 Managed Instance Group

- 若你要混合不同類型 VM，可考慮 Unmanaged Instance Group，但功能有限

## 建立 MIG

- 前置條件：需要先有實例範本（Instance Template），裡面定義了 VM 的機器類型、映像檔等配置
- 相關參數解釋
  - 設定自動擴展（Auto-scaling）
    - 設定最大和最小的 instance 數量，可以設定觸發條件，比如 CPU 使用率達到多少之類
  - 設定冷卻期（Cool Down Period）
    - 避免過度頻繁做擴展，可以設定比如擴展後等待 60 秒才再次檢查是否需要縮減
  - 設定縮減控制（Scale-in Control）
    - 避免實例數量驟降造成服務中斷，比如 5 分鐘內最多只允許減少 10% 或 3 台實例
  - 設定自我修復（Auto-healing）
    - 設定健康檢查（Health Check）以判定 VM 是否健康
   
- 建置路徑：`Google Cloud Console → Compute Engine → Instance Groups`     
